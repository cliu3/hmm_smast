<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ge_quiver3</title>
  <meta name="keywords" content="ge_quiver3">
  <meta name="description" content="Reference page in help browser:">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">dependencies</a> &gt; <a href="#">googleearthtoolbox</a> &gt; <a href="index.html">matlab</a> &gt; ge_quiver3.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for dependencies/googleearthtoolbox/matlab&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>ge_quiver3
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Reference page in help browser:</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function tag_str = ge_quiver3(XM,YM,ZM,UM,VM,WM,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Reference page in help browser: 

 &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','ge_quiver3.html'),'-helpbrowser')&quot;&gt;link&lt;/a&gt; to html documentation
 &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','license.html'),'-helpbrowser')&quot;&gt;show license statement&lt;/a&gt;</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="authoptions.html" class="code" title="function [AuthorizedOptions] = authoptions( filename )">authoptions</a>	% all available options to each function</li><li><a href="parsepairs.html" class="code" title="">parsepairs</a>	% Please use the link below to view the documentation.</li><li><a href="rad2deg.html" class="code" title="function [angle_deg] = rad2deg( angle_rad )">rad2deg</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../dependencies/googleearthtoolbox/matlab/demo/demo_ge_quiver3_1.html" class="code" title="function demo_ge_quiver3_1()%% Demo ge_quiver3">demo_ge_quiver3_1</a>	</li><li><a href="../../../dependencies/googleearthtoolbox/matlab/demo/demo_ge_quiver3_2.html" class="code" title="function demo_ge_quiver3_2()">demo_ge_quiver3_2</a>	Define the location of the Collada model origin:</li><li><a href="ge_windbarb.html" class="code" title="function kmlStr = ge_windbarb(X,Y,Z,U,V,varargin)">ge_windbarb</a>	% Reference page in help browser:</li><li><a href="../../../dependencies/googleearthtoolbox/matlab/tests/test_dyn_vis.html" class="code" title="">test_dyn_vis</a>	</li><li><a href="../../../dependencies/googleearthtoolbox/matlab/tests/test_ge_quiver3.html" class="code" title="">test_ge_quiver3</a>	Define the location of the Collada model origin:</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function a = calc_dir(U,V)</a></li><li><a href="#_sub2" class="code">function d = rad2deg(r)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function tag_str = ge_quiver3(XM,YM,ZM,UM,VM,WM,varargin)</a>
0002 <span class="comment">% Reference page in help browser:</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','ge_quiver3.html'),'-helpbrowser')&quot;&gt;link&lt;/a&gt; to html documentation</span>
0005 <span class="comment">% &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','license.html'),'-helpbrowser')&quot;&gt;show license statement&lt;/a&gt;</span>
0006 <span class="comment">%</span>
0007 
0008 AuthorizedOptions = <a href="authoptions.html" class="code" title="function [AuthorizedOptions] = authoptions( filename )">authoptions</a>( mfilename );
0009 
0010 
0011 
0012     altitudeMode = <span class="string">'absolute'</span>;
0013       arrowScale = 1;
0014     modelLinkStr = <span class="string">'[No model link specified]'</span>;
0015             name = <span class="string">'ge_quiver3'</span>;
0016        timeStamp = <span class="string">' '</span>;
0017    timeSpanStart = <span class="string">' '</span>;
0018     timeSpanStop = <span class="string">' '</span>;
0019     snippet      = <span class="string">' '</span>;
0020     description = <span class="string">''</span>;
0021          region = <span class="string">' '</span>;
0022 fixedArrowLength = 0; 
0023      msgToScreen = false;
0024 
0025 <a href="parsepairs.html" class="code" title="">parsepairs</a> <span class="comment">%script that parses Parameter/Value pairs.</span>
0026 
0027 <span class="keyword">if</span> msgToScreen
0028     disp([<span class="string">'Running: '</span>,mfilename,<span class="string">'...'</span>])
0029 <span class="keyword">end</span>
0030 
0031 <span class="keyword">if</span> region == <span class="string">' '</span>
0032     region_chars = <span class="string">''</span>;
0033 <span class="keyword">else</span>
0034     region_chars = [ region, 10 ];
0035 <span class="keyword">end</span>
0036 
0037 <span class="keyword">if</span> ~(isequal(altitudeMode,<span class="string">'clampToGround'</span>)||<span class="keyword">...</span>
0038    isequal(altitudeMode,<span class="string">'relativeToGround'</span>)||<span class="keyword">...</span>
0039    isequal(altitudeMode,<span class="string">'absolute'</span>))
0040 
0041     error([<span class="string">'Variable '</span>,39,<span class="string">'altitudeMode'</span>,39, <span class="string">' should be one of '</span> ,39,<span class="string">'clampToGround'</span>,39,<span class="string">', '</span>,10,39,<span class="string">'relativeToGround'</span>,39,<span class="string">', or '</span>,39,<span class="string">'absolute'</span>,39,<span class="string">'.'</span> ])
0042     
0043 <span class="keyword">end</span>   
0044 
0045 <span class="keyword">if</span> ~ismember(fixedArrowLength,[0,1])
0046     error([<span class="string">'Function '</span>,39,mfilename,39,<span class="string">': variable '</span>,39,<span class="string">'fixedArrowLength'</span>,39,<span class="string">' may only be 0 or 1.'</span>])
0047 <span class="keyword">end</span>
0048 
0049 
0050 <span class="keyword">if</span> timeStamp == <span class="string">' '</span>
0051     timeStamp_chars = <span class="string">''</span>;
0052 <span class="keyword">else</span>
0053     timeStamp_chars = [ <span class="string">'&lt;TimeStamp&gt;&lt;when&gt;'</span> timeStamp <span class="string">'&lt;/when&gt;&lt;/TimeStamp&gt;'</span>,10 ];
0054 <span class="keyword">end</span>
0055 
0056 <span class="keyword">if</span> timeSpanStart == <span class="string">' '</span>
0057     timeSpan_chars = <span class="string">''</span>;
0058 <span class="keyword">else</span>
0059     <span class="keyword">if</span> timeSpanStop == <span class="string">' '</span> 
0060         timeSpan_chars = [ <span class="string">'&lt;TimeSpan&gt;&lt;begin&gt;'</span> timeSpanStart <span class="string">'&lt;/begin&gt;&lt;/TimeSpan&gt;'</span>,10 ];
0061     <span class="keyword">else</span>
0062         timeSpan_chars = [ <span class="string">'&lt;TimeSpan&gt;&lt;begin&gt;'</span> timeSpanStart <span class="string">'&lt;/begin&gt;&lt;end&gt;'</span> timeSpanStop <span class="string">'&lt;/end&gt;&lt;/TimeSpan&gt;'</span>,10 ];    
0063     <span class="keyword">end</span>
0064         
0065 <span class="keyword">end</span>
0066 
0067 <span class="keyword">if</span> snippet == <span class="string">' '</span>
0068     snippet_chars = <span class="string">''</span>;
0069 <span class="keyword">else</span>
0070     snippet_chars = [ <span class="string">'&lt;Snippet&gt;'</span> snippet <span class="string">'&lt;/Snippet&gt;'</span>,10 ];    
0071 <span class="keyword">end</span>
0072 
0073 description_chars = [ <span class="string">'&lt;description&gt;'</span>,10,<span class="string">'&lt;![CDATA['</span> description <span class="string">']]&gt;'</span>,10,<span class="string">'&lt;/description&gt;'</span>,10 ];
0074 
0075 tag_str = [<span class="string">'&lt;Placemark&gt;'</span> 10,<span class="keyword">...</span>
0076                 snippet_chars,<span class="keyword">...</span>
0077                 description_chars,<span class="keyword">...</span>
0078                 timeStamp_chars,<span class="keyword">...</span>
0079                 timeSpan_chars,<span class="keyword">...</span>
0080                 region_chars,<span class="keyword">...</span>
0081                 <span class="string">'&lt;name&gt;'</span>,name,<span class="string">'&lt;/name&gt;'</span> 10,<span class="keyword">...</span>
0082                 <span class="string">'&lt;MultiGeometry&gt;'</span> 10];
0083 
0084 xv = XM(:);
0085 yv = YM(:);
0086 zv = ZM(:);
0087 
0088 uv = UM(:);
0089 vv = VM(:);
0090 wv = WM(:);
0091 
0092 av = sqrt(uv.^2+vv.^2+wv.^2);
0093 
0094 clear XM YM ZM UM VM WM
0095 
0096 heading = zeros(size(xv));
0097 tilt = zeros(size(xv));
0098 roll = zeros(size(xv));
0099 
0100 
0101 <span class="keyword">for</span> k=1:length(xv)
0102 
0103     heading(k) = <a href="rad2deg.html" class="code" title="function [angle_deg] = rad2deg( angle_rad )">rad2deg</a>(<a href="#_sub1" class="code" title="subfunction a = calc_dir(U,V)">calc_dir</a>(uv(k),vv(k)));
0104 <span class="comment">%    tilt(k) = rad2deg(calc_dir(wv(k),sqrt(uv(k).^2 + vv(k).^2)));</span>
0105     tilt(k) = <a href="rad2deg.html" class="code" title="function [angle_deg] = rad2deg( angle_rad )">rad2deg</a>(<a href="#_sub1" class="code" title="subfunction a = calc_dir(U,V)">calc_dir</a>(sqrt(uv(k).^2 + vv(k).^2),wv(k)))-90;
0106 <span class="comment">%     if tilt(k)&lt;-90||tilt(k)&gt;90</span>
0107 <span class="comment">%          error(['Google Earth can do tilts from -90 (straight up) to 90 (straight down). ',10,...</span>
0108 <span class="comment">%                  'Current value is ' num2str(tilt(k)),'.'])</span>
0109 <span class="comment">%     end</span>
0110     tag_str = [tag_str,<span class="keyword">...</span>
0111                 <span class="string">'&lt;Model&gt;'</span>, 10,<span class="keyword">...</span>
0112                 <span class="string">'&lt;altitudeMode&gt;'</span> altitudeMode <span class="string">'&lt;/altitudeMode&gt;'</span>, 10,<span class="keyword">...</span>
0113                 <span class="string">'&lt;Location&gt;'</span>, 10,<span class="keyword">...</span>
0114                 <span class="string">'   &lt;longitude&gt;'</span> num2str(xv(k))  <span class="string">'&lt;/longitude&gt;'</span>, 10,<span class="keyword">...</span>
0115                 <span class="string">'   &lt;latitude&gt;'</span> num2str(yv(k)) <span class="string">'&lt;/latitude&gt;'</span>, 10,<span class="keyword">...</span>
0116                 <span class="string">'   &lt;altitude&gt;'</span> num2str(zv(k)) <span class="string">'&lt;/altitude&gt;'</span>, 10,<span class="keyword">...</span>
0117                 <span class="string">'&lt;/Location&gt;'</span>, 10,<span class="keyword">...</span>
0118                 <span class="string">'&lt;Orientation&gt;'</span>, 10,<span class="keyword">...</span>
0119                 <span class="string">'   &lt;heading&gt;'</span> num2str(heading(k))  <span class="string">'&lt;/heading&gt;'</span>, 10,<span class="keyword">...</span>
0120                 <span class="string">'   &lt;tilt&gt;'</span> num2str(tilt(k)) <span class="string">'&lt;/tilt&gt;'</span>, 10,<span class="keyword">...</span>
0121                 <span class="string">'   &lt;roll&gt;'</span> num2str(roll(k)) <span class="string">'&lt;/roll&gt;'</span>, 10,<span class="keyword">...</span>
0122                 <span class="string">'&lt;/Orientation&gt;'</span>, 10,<span class="keyword">...</span>
0123                 <span class="string">'&lt;Scale&gt;'</span>, 10'];
0124     <span class="keyword">if</span> fixedArrowLength==1
0125         tag_str = [tag_str,<span class="keyword">...</span>
0126                 <span class="string">'   &lt;x&gt;'</span>,num2str(arrowScale),<span class="string">'&lt;/x&gt;'</span>, 10,<span class="keyword">...</span>
0127                 <span class="string">'   &lt;y&gt;'</span>,num2str(arrowScale),<span class="string">'&lt;/y&gt;'</span>, 10,<span class="keyword">...</span>
0128                 <span class="string">'   &lt;z&gt;'</span>,num2str(arrowScale),<span class="string">'&lt;/z&gt;'</span>, 10];
0129     <span class="keyword">else</span>
0130         tag_str = [tag_str,<span class="keyword">...</span>
0131                 <span class="string">'   &lt;x&gt;'</span>,num2str(arrowScale*av(k)),<span class="string">'&lt;/x&gt;'</span>, 10,<span class="keyword">...</span>
0132                 <span class="string">'   &lt;y&gt;'</span>,num2str(arrowScale*av(k)),<span class="string">'&lt;/y&gt;'</span>, 10,<span class="keyword">...</span>
0133                 <span class="string">'   &lt;z&gt;'</span>,num2str(arrowScale*av(k)),<span class="string">'&lt;/z&gt;'</span>, 10];
0134     <span class="keyword">end</span>
0135     
0136     tag_str = [tag_str,<span class="keyword">...</span>
0137                 <span class="string">'&lt;/Scale&gt;'</span>, 10,<span class="keyword">...</span>
0138                 <span class="string">'&lt;Link&gt;'</span>, 10,<span class="keyword">...</span>
0139                 <span class="string">'   &lt;href&gt;'</span> modelLinkStr <span class="string">'&lt;/href&gt;'</span>, 10,<span class="keyword">...</span>
0140                 <span class="string">'&lt;/Link&gt;'</span>, 10,<span class="keyword">...</span>
0141                 <span class="string">'&lt;/Model&gt;'</span>, 10, 10, 10 ];
0142                 
0143 <span class="keyword">end</span>
0144                 
0145 tag_str = [tag_str, 10,<span class="keyword">...</span>
0146            <span class="string">'&lt;/MultiGeometry&gt;'</span> 10,<span class="keyword">...</span>
0147            <span class="string">'&lt;/Placemark&gt;'</span> 10];
0148 
0149 <span class="keyword">if</span> msgToScreen
0150     disp([<span class="string">'Running: '</span>,mfilename,<span class="string">'...Done'</span>])
0151 <span class="keyword">end</span>
0152     
0153 
0154 
0155 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0156 <a name="_sub1" href="#_subfunctions" class="code">function a = calc_dir(U,V)</a>
0157 
0158 dy = V;
0159 dx = U;
0160 
0161 <span class="keyword">if</span> (dy==0) &amp;&amp; (dx==0)
0162     a=0;
0163 <span class="comment">%     error(['Unable to determine the direction of' 10 'a zero-length vector. Function: ' 39 mfilename 39 '.'])</span>
0164 <span class="keyword">elseif</span> (dy==0)&amp;&amp;(dx&gt;0)
0165     a = 0.5*pi;
0166 <span class="keyword">elseif</span> (dy==0)&amp;&amp;(dx&lt;0)
0167     a = 1.5*pi;
0168 <span class="keyword">elseif</span> (dy&gt;0)&amp;&amp;(dx==0)
0169     a = 0;
0170 <span class="keyword">elseif</span> (dy&lt;0)&amp;&amp;(dx==0)
0171     a = pi;    
0172 <span class="keyword">elseif</span> (dy&gt;0)&amp;&amp;(dx&gt;0)
0173     a = mod(atan(dx/dy),2*pi);<span class="comment">%#</span>
0174 <span class="keyword">elseif</span> (dy&gt;0)&amp;&amp;(dx&lt;0)
0175     a = mod(atan(dx/dy),2*pi);<span class="comment">%#</span>
0176 <span class="keyword">elseif</span> (dy&lt;0)&amp;&amp;(dx&gt;0)
0177     a = mod(pi+atan(dx/dy),2*pi);<span class="comment">%#</span>
0178 <span class="keyword">elseif</span> (dy&lt;0)&amp;&amp;(dx&lt;0)
0179     a = mod(pi+atan(dx/dy),2*pi);<span class="comment">%#</span>
0180 <span class="keyword">else</span>
0181     a=NaN;<span class="comment">%#</span>
0182 <span class="keyword">end</span>
0183 
0184 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0185 <a name="_sub2" href="#_subfunctions" class="code">function d = rad2deg(r)</a>
0186 
0187 d = (r/(2*pi))*360;
0188 
0189</pre></div>
<hr><address>Generated on Tue 27-Sep-2016 19:23:04 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>