<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ge_imagesc_TMP</title>
  <meta name="keywords" content="ge_imagesc_TMP">
  <meta name="description" content="Reference page in help browser:">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">dependencies</a> &gt; <a href="#">googleearthtoolbox</a> &gt; <a href="index.html">matlab</a> &gt; ge_imagesc_TMP.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for dependencies/googleearthtoolbox/matlab&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>ge_imagesc_TMP
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Reference page in help browser:</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [kmlStr] = ge_imagesc(x,y,data,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Reference page in help browser: 
 
 &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','ge_imagesc.html'),'-helpbrowser')&quot;&gt;link&lt;/a&gt; to html documentation
 &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','license.html'),'-helpbrowser')&quot;&gt;show license statement&lt;/a&gt;</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="authoptions.html" class="code" title="function [AuthorizedOptions] = authoptions( filename )">authoptions</a>	% all available options to each function</li><li><a href="ge_groundoverlay.html" class="code" title="function output = ge_groundoverlay(y_max,x_max,y_min,x_min,varargin)">ge_groundoverlay</a>	Reference page in help browser:</li><li><a href="ge_imagesc.html" class="code" title="function [kmlStr] = ge_imagesc(x,y,data,varargin)">ge_imagesc</a>	Reference page in help browser:</li><li><a href="parsepairs.html" class="code" title="">parsepairs</a>	% Please use the link below to view the documentation.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [kmlStr] = ge_imagesc(x,y,data,varargin)</a>
0002 <span class="comment">% Reference page in help browser:</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','ge_imagesc.html'),'-helpbrowser')&quot;&gt;link&lt;/a&gt; to html documentation</span>
0005 <span class="comment">% &lt;a href=&quot;matlab:web(fullfile(ge_root,'html','license.html'),'-helpbrowser')&quot;&gt;show license statement&lt;/a&gt;</span>
0006 <span class="comment">%</span>
0007 
0008 AuthorizedOptions = <a href="authoptions.html" class="code" title="function [AuthorizedOptions] = authoptions( filename )">authoptions</a>( mfilename );
0009 
0010 
0011 <span class="keyword">if</span> isempty(x)||isempty(y)
0012     error(<span class="string">'empty coordinates passed to ge_imagesc().'</span>);
0013 <span class="keyword">elseif</span> isempty(data) 
0014     error(<span class="string">'Empty data array passed to ge_imagesc().'</span>);    
0015 <span class="keyword">end</span>
0016 
0017            id = <span class="string">'imagesc'</span>;
0018 <span class="comment">%       idTag = 'id';</span>
0019    visibility = 1;
0020     lineColor = <span class="string">'00000000'</span>;
0021     timeStamp = <span class="string">' '</span>;
0022 timeSpanStart = <span class="string">' '</span>;
0023  timeSpanStop = <span class="string">' '</span>;
0024     lineWidth = 0.25;
0025       snippet = <span class="string">' '</span>;
0026      altitude = 1.0;
0027       extrude = 0;
0028  altitudeMode = <span class="string">'clampToGround'</span>;
0029   msgToScreen = 0;
0030          cMap = <span class="string">'jet'</span>;
0031 dataFormatStr = <span class="string">'%g'</span>;  
0032        imgURL = <span class="string">'ge_imagesc.png'</span>;
0033          name = <span class="string">'ge_imagesc'</span>;
0034    tessellate = 1;
0035        region = <span class="string">' '</span>;
0036   alphaMatrix = double(~isnan(data));
0037   crispFactor = 5;  
0038       nColors = 256;
0039  useSubBlocks = false;
0040        
0041 <span class="comment">%      cLimHigh: see further down</span>
0042 <span class="comment">%       cLimLow: see further down</span>
0043 
0044 
0045 <span class="keyword">if</span> size(x)~=size(data)
0046     error([<span class="string">'size of longitude array should be same as size of data array.'</span>])
0047 <span class="keyword">end</span>
0048 <span class="keyword">if</span> size(y)~=size(data)
0049     error([<span class="string">'size of latitude array should be same as size of data array.'</span>])
0050 <span class="keyword">end</span>
0051 
0052 dy = y(2:<span class="keyword">end</span>,1)-y(1:end-1,1);
0053 dx = x(1,2:end)-x(1,1:end-1);
0054 
0055 <span class="keyword">if</span> dy&lt;0
0056     y = flipud(y)
0057     data = flipud(data)
0058 <span class="keyword">elseif</span> dy==0
0059     error(<span class="string">'Latitude resolution can not be zero.'</span>)
0060 <span class="keyword">else</span>
0061 <span class="keyword">end</span>
0062 
0063 <span class="keyword">if</span> dx&lt;0
0064     x = fliplr(x)
0065     error(<span class="string">'Longitude resolution can not be negative.'</span>)
0066 <span class="keyword">elseif</span> dx==0
0067     error(<span class="string">'Longitude resolution can not be zero.'</span>)
0068 <span class="keyword">else</span>
0069 <span class="keyword">end</span>
0070 
0071 <span class="comment">% if any(abs(dy(2:end)-dy(1:end-1))&gt;1e-12)||any(abs(dx(2:end)-dx(1:end-1))&gt;1e-12)</span>
0072 <span class="comment">%     error(['Function ' 39 mfilename 39 ' does not allow varying grid cell size.'])</span>
0073 <span class="comment">% end</span>
0074 <span class="comment">% clear dx dy</span>
0075 xResolution = abs(x(2)-x(1));
0076 yResolution = abs(y(2)-y(1));
0077 
0078 <a href="parsepairs.html" class="code" title="">parsepairs</a> <span class="comment">%script that parses Parameter/Value pairs.</span>
0079 
0080 
0081 <span class="keyword">if</span> msgToScreen
0082    disp([<span class="string">'Running '</span> mfilename <span class="string">'...'</span>]) 
0083 <span class="keyword">end</span>
0084 
0085 <span class="keyword">if</span> ~(isequal(altitudeMode,<span class="string">'clampToGround'</span>)||<span class="keyword">...</span>
0086    isequal(altitudeMode,<span class="string">'relativeToGround'</span>)||<span class="keyword">...</span>
0087    isequal(altitudeMode,<span class="string">'absolute'</span>))
0088 
0089     error([<span class="string">'Variable '</span>,39,<span class="string">'altitudeMode'</span>,39, <span class="string">' should be one of '</span> ,39,<span class="string">'clampToGround'</span>,39,<span class="string">', '</span>,10,39,<span class="string">'relativeToGround'</span>,39,<span class="string">', or '</span>,39,<span class="string">'absolute'</span>,39,<span class="string">'.'</span> ])
0090     
0091 <span class="keyword">end</span>   
0092 
0093 <span class="keyword">if</span> numel(xResolution)~=1
0094     error([<span class="string">'Function '</span>,39,mfilename,39,<span class="string">': variable '</span>,39,<span class="string">'xResolution'</span>,39,<span class="string">' should be scalar.'</span>])
0095 <span class="keyword">end</span>
0096 
0097 <span class="keyword">if</span> numel(yResolution)~=1
0098     error([<span class="string">'Function '</span>,39,mfilename,39,<span class="string">': variable '</span>,39,<span class="string">'yResolution'</span>,39,<span class="string">' should be scalar.'</span>])
0099 <span class="keyword">end</span>
0100 
0101 <span class="keyword">if</span> ~((length(x)&gt;1)&amp;&amp;(length(y)&gt;1))
0102     error([<span class="string">'Input variables '</span> 39 <span class="string">'x'</span> 39 <span class="string">' and '</span> 39 <span class="string">'y'</span> 39 <span class="string">' should at least contain 2 values.'</span>])
0103 <span class="keyword">end</span>
0104 
0105 <span class="keyword">if</span> exist(<span class="string">'nanValue'</span>,<span class="string">'var'</span>)&amp;&amp;~isnan(nanValue)
0106     data(data==nanValue)=NaN;
0107 <span class="keyword">end</span>
0108 <span class="keyword">if</span> ~exist(<span class="string">'cLimHigh'</span>,<span class="string">'var'</span>)
0109     cLimHigh = max(data(:));
0110 <span class="keyword">end</span>
0111 <span class="keyword">if</span> ~exist(<span class="string">'cLimLow'</span>,<span class="string">'var'</span>)
0112     cLimLow = min(data(:));
0113 <span class="keyword">end</span>
0114 
0115 
0116 
0117 halfLonRes = 0.5*xResolution;     
0118 halfLatRes = 0.5*yResolution;
0119 N = max(y)+halfLatRes;
0120 E = max(x)+halfLonRes;
0121 S = min(y)-halfLatRes;
0122 W = min(x)-halfLonRes;
0123 
0124 <span class="keyword">if</span> useSubBlocks
0125     
0126     defaultLatBlockSize = 1
0127     defaultLonBlockSize = 1
0128     
0129     latVec = S:defaultLatBlockSize:N
0130     lonVec = W:defaultLonBlockSize:E
0131 
0132     inputParams = varargin;
0133     Ix = strmatch(<span class="string">'useSubBlocks'</span>,inputParams(1:2:end));
0134     inputParams{Ix*2} = false;
0135     clear IX
0136     
0137     Ix = strmatch(<span class="string">'imgURL'</span>,inputParams(1:2:end));
0138     inputParams = inputParams([1:Ix-1,Ix+2:6]);
0139 
0140     [lons,lats] = meshgrid(x,y);
0141     kmlStr = <span class="string">''</span>;
0142     
0143     <span class="keyword">for</span> iLat = 2:numel(latVec)
0144         <span class="keyword">for</span> iLon = 2:numel(lonVec)
0145             
0146             IO = (lonVec(iLon-1)&lt;=lons) &amp; (lons &lt; lonVec(iLon)) &amp;<span class="keyword">...</span>
0147                  (latVec(iLat-1)&lt;=lats) &amp; (lats &lt; latVec(iLat))
0148            
0149             ind = find(IO,1,<span class="string">'first'</span>);
0150             [rs,cs] = ind2sub(size(IO),ind)
0151             clear ind
0152             
0153             ind = find(IO,1,<span class="string">'last'</span>)
0154             [re,ce] = ind2sub(size(IO),ind)
0155             clear ind
0156             
0157             lonBlock = lons(rs:re,cs:ce)
0158             latBlock = lats(rs:re,cs:ce)
0159             dataBlock = data(rs:re,cs:ce)
0160 
0161             figure(1)
0162             imagesc(lonBlock(1,:),latBlock(:,1),dataBlock)
0163             colorbar
0164             drawnow
0165             
0166             imgURLBlock = [imgURL(1:end-4),<span class="string">'_'</span>,num2str(iLon-1),<span class="string">'_'</span>,<span class="keyword">...</span>
0167                 num2str(iLat-1),imgURL(end-3:end)]
0168             
0169             kmlStr = [kmlStr,<a href="ge_imagesc.html" class="code" title="function [kmlStr] = ge_imagesc(x,y,data,varargin)">ge_imagesc</a>(lonBlock(1,:),latBlock(:,1),dataBlock,<span class="keyword">...</span>
0170                 inputParams{:},<span class="string">'imgURL'</span>,imgURLBlock,<span class="string">'name'</span>,[<span class="string">'[r,c] = ['</span>,<span class="keyword">...</span>
0171                 num2str(iLat-1),<span class="string">','</span>,num2str(iLon-1),<span class="string">']'</span>])]
0172         <span class="keyword">end</span>
0173     <span class="keyword">end</span>
0174     <span class="keyword">return</span>
0175 
0176 <span class="keyword">else</span>
0177 
0178     [nRows,nCols] = size(data);
0179 
0180 
0181     <span class="keyword">if</span> crispFactor == 1
0182         dataXL = data;
0183         alphaMatrixXL = alphaMatrix;
0184     <span class="keyword">else</span>
0185 
0186         dataXL = repmat(NaN,[nRows,nCols]*crispFactor);
0187         alphaMatrixXL = repmat(NaN,[nRows,nCols]*crispFactor);
0188 
0189         <span class="keyword">for</span> r=1:nRows
0190             <span class="keyword">for</span> c=1:nCols
0191 
0192                 sr = (r-1)*crispFactor+1;
0193                 er = r*crispFactor;
0194 
0195                 sc = (c-1)*crispFactor+1;
0196                 ec = c*crispFactor;
0197 
0198                 dataXL(sr:er,sc:ec) = data(r,c);
0199 
0200                 <span class="keyword">if</span> isnan(data(r,c))
0201                     alphaMatrixXL(sr:er,sc:ec) =  0;
0202                 <span class="keyword">else</span>
0203                     alphaMatrixXL(sr:er,sc:ec) =  alphaMatrix(r,c);
0204                 <span class="keyword">end</span>
0205             <span class="keyword">end</span>
0206         <span class="keyword">end</span>
0207 
0208     <span class="keyword">end</span>
0209 
0210     data3 = mat2gray(dataXL,[cLimLow,cLimHigh]);
0211 
0212     <span class="keyword">if</span> ischar(cMap)
0213         X = gray2ind(data3,nColors);
0214         eval([<span class="string">'data3 = ind2rgb(X,'</span>,cMap,<span class="string">'('</span>,num2str(nColors),<span class="string">'));'</span>]);
0215     <span class="keyword">else</span>
0216         nColors = size(cMap,1);
0217         X = gray2ind(data3,nColors);
0218         data3 = ind2rgb(X,cMap);    
0219     <span class="keyword">end</span>
0220 
0221     imwrite(data3,imgURL,<span class="string">'png'</span>,<span class="string">'alpha'</span>,alphaMatrixXL,<span class="keyword">...</span>
0222         <span class="string">'CreationTime'</span>,datestr(now,21),<span class="keyword">...</span>
0223         <span class="string">'Comment'</span>,<span class="string">'Created by the GoogleEarth Toolbox for MATLAB'</span>);
0224 
0225 
0226     kmlStr = <a href="ge_groundoverlay.html" class="code" title="function output = ge_groundoverlay(y_max,x_max,y_min,x_min,varargin)">ge_groundoverlay</a>(N,E,S,W,<span class="keyword">...</span>
0227                                <span class="string">'name'</span>,name,<span class="keyword">...</span>
0228                              <span class="string">'imgURL'</span>,imgURL,<span class="keyword">...</span>
0229                             <span class="string">'snippet'</span>, snippet,<span class="keyword">...</span>
0230                           <span class="string">'timeStamp'</span>,timeStamp,<span class="keyword">...</span>
0231                       <span class="string">'timeSpanStart'</span>,timeSpanStart,<span class="keyword">...</span>
0232                        <span class="string">'timeSpanStop'</span>,timeSpanStop,<span class="keyword">...</span>
0233                          <span class="string">'visibility'</span>,visibility,<span class="keyword">...</span>
0234                            <span class="string">'altitude'</span>,altitude,<span class="keyword">...</span>
0235                             <span class="string">'extrude'</span>,extrude,<span class="keyword">...</span>
0236                             <span class="string">'region'</span>,region,<span class="keyword">...</span>
0237                        <span class="string">'altitudeMode'</span>,altitudeMode);
0238 
0239 
0240     <span class="keyword">if</span> msgToScreen
0241        disp([<span class="string">'Running '</span> mfilename <span class="string">'...Done'</span>]) 
0242     <span class="keyword">end</span>
0243 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 27-Sep-2016 19:23:04 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>